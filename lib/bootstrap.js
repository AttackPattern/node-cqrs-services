"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _regenerator=require("babel-runtime/regenerator"),_regenerator2=_interopRequireDefault(_regenerator),_assign=require("babel-runtime/core-js/object/assign"),_assign2=_interopRequireDefault(_assign),_asyncToGenerator2=require("babel-runtime/helpers/asyncToGenerator"),_asyncToGenerator3=_interopRequireDefault(_asyncToGenerator2),_classCallCheck2=require("babel-runtime/helpers/classCallCheck"),_classCallCheck3=_interopRequireDefault(_classCallCheck2),_v=require("uuid/v4"),_v2=_interopRequireDefault(_v),_events=require("./domain/user/events"),hasRun=!1,Bootstrap=function e(){(0,_classCallCheck3.default)(this,e)};Bootstrap.assureInitialized=function(){var e=(0,_asyncToGenerator3.default)(_regenerator2.default.mark(function e(r){var t,a=r.systemUser,s=r.userRepository,n=r.authStore;return _regenerator2.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=hasRun,e.t0){e.next=5;break}return e.next=4,s.get(a.userId);case 4:e.t0=!!e.sent;case 5:if(!e.t0){e.next=7;break}return e.abrupt("return");case 7:return console.log('bootstraping system user "'+a.username+'"'),e.next=10,n.addLogin({userId:a.userId,username:a.username,password:a.password,claims:{roles:["systemAdmin"]}});case 10:return t=[(0,_assign2.default)(new _events.Created({username:a.username,profile:a.profile}),{sequenceNumber:1,aggregateId:a.userId,actor:"bootstrap"})],e.next=13,s.record(t);case 13:hasRun=!0;case 14:case"end":return e.stop()}},e,void 0)}));return function(r){return e.apply(this,arguments)}}(),exports.default=Bootstrap,module.exports=exports.default;
//# sourceMappingURL=maps/bootstrap.js.map
